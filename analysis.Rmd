---
title: "The attentive online reading: do eye movement modeling examples enhance navigation and evaluation of multiple documents in English (L2)?"
output:
  pdf_document:
    toc: yes
    toc_depth: '5'
  html_notebook:
    toc: yes
    toc_depth: 5
    number_sections: yes
  word_document:
    toc: yes
    toc_depth: '5'
bibliography: references.bib
csl: instituto-brasileiro-de-informacao-em-ciencia-e-tecnologia-abnt-initials.csl
---

# Preliminary Analyses

```{r include=FALSE}
# Load packages
library(tidyverse)  # Helper functions
library(lme4)       # Mixed-effect models
library(sjPlot)     # Model plotting
library(datawizard) # Skewness and Kurtosis functions
library(jtools)     # APA theme
library(gridExtra)  # Multiple plots in one single image

# Configure APA theme for figures
set_theme(theme_apa())

# Prevent scientific notation
options(scipen = 999)

# Load raw data for RQ1
rq1 = read.table('data/RQ1sem_soma.csv', 
                 sep = ';', 
                 dec = ',',
                 encoding = 'UTF-8',
                 header = 1) %>%
  as_tibble()

# Load raw data for RQ2
rq2_source_features = read.table('data/RQ2evaluationSourceFeaturessemSoma.csv', 
                 sep = ';', 
                 encoding = 'UTF-8', 
                 header = 1) %>%
  as_tibble()

rq2_reliability = read.table('data/RQ2evaluationRelevantsemSoma.csv',
                             sep = ';',
                             encoding = 'UTF-8',
                             header = 1) %>%
  as_tibble() %>%
  mutate(AOI = 'Reliable') %>%
  bind_rows(
    read.table('data/RQ2evaluationIrrelevantSemsoma.csv',
               sep = ';',
               encoding = 'UTF-8',
               header = 1) %>%
      as_tibble() %>%
      mutate(AOI = 'Non-reliable')
  )

# Load raw data for RQ3
rq3 = read.table('data/RQ3surveyNavigation.csv', 
                 sep = ';',
                 encoding = 'UTF-8',
                 header = 1) %>%
  as_tibble()

# Load raw data for RQ4
rq4 = read.table('data/RQ4coding.csv',
                 sep = ';',
                 encoding = 'UTF-8',
                 header = 1) %>%
  as_tibble() %>%
  pivot_longer(starts_with('LS'), 
               names_to = 'test', 
               values_to = 'response') %>%
  mutate(test = test %>% str_sub(4)) %>%
  group_by(Participant, test) %>%
  summarize(meanResponse = mean(response)) %>%
  mutate(Group = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,2],
         Participant = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,3]) %>%
  relocate(Participant, Group)
```

## Outliers Detection and Replacement

Individual fixations that lasted two standart deviations above or below each participant fixation duration mean were considered outliers and were replaced by the participant fixation duration median[see @Salmeron2020, p. 1045]. Outliers represented 2.6% of individual fixations on the web page headers and snippets within the SERP.

```{r message=FALSE, warning=FALSE, include=FALSE}

# Check outliers (individual fixations that lasted two SD above or below each student mean)
rq1 = rq1 %>% 
  group_by(Participant) %>%
  mutate(M = mean(Event.Duration..ms.),
         SD = sd(Event.Duration..ms.),
         outlier = Event.Duration..ms. > M + (2 * SD) || 
           Event.Duration..ms. < M - (2 * SD),
         Median = median(Event.Duration..ms.))

rq2_source_features = rq2_source_features %>%
  group_by(Participant) %>%
  mutate(M = mean(Event.Duration..ms.),
         SD = sd(Event.Duration..ms.),
         outlier = Event.Duration..ms. > M + (2 * SD) || 
           Event.Duration..ms. < M - (2 * SD),
         Median = median(Event.Duration..ms.))

rq2_reliability = rq2_reliability %>%
  group_by(Participant, AOI) %>%
  mutate(M = mean(Event.Duration..ms.),
         SD = sd(Event.Duration..ms.),
         outlier = Event.Duration..ms. > M + (2 * SD) || 
           Event.Duration..ms. < M - (2 * SD),
         Median = median(Event.Duration..ms.))

# Replace outlier with participant's median
rq1 = rq1 %>%
  mutate(Event.Duration..ms. = 
           ifelse(outlier, Median, Event.Duration..ms.))

rq2_source_features = rq2_source_features %>%
  mutate(Event.Duration..ms. = 
           ifelse(outlier, Median, Event.Duration..ms.))

rq2_reliability = rq2_reliability %>%
  mutate(Event.Duration..ms. = 
           ifelse(outlier, Median, Event.Duration..ms.))

# Sum the fixations
rq1 = rq1 %>%
  summarise(EventDuration = sum(Event.Duration..ms.)) %>%
  mutate(Group = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,2],
         Participant = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,3]) %>%
  relocate(Participant, Group)

rq2_source_features = rq2_source_features %>%
  summarise(EventDuration = sum(Event.Duration..ms.)) %>%
  mutate(Group = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,2],
         Participant = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,3]) %>%
  relocate(Participant, Group)

rq2_reliability = rq2_reliability  %>%
  summarise(EventDuration = sum(Event.Duration..ms.)) %>%
  mutate(Group = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,2],
         Participant = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,3]) %>%
  relocate(Participant, Group)

rq3 = rq3 %>%
  mutate(Group = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,2],
         Participant = Participant %>% 
           str_match('([A-Z]+)(\\d+)') %>%
           .[,3]) %>%
  relocate(Participant, Group)
```

## Tests of Normality and Data Transformation

Figure 1 shows the frequency distributions of the time variables used in the study. All distributions have skewness values higher than 0.5, being right-skewed, as it is commonly observed with time variables. The variables were log-transformed to better approximated to a normal distribution. The log-transformed variables are shown in Figure 2 with their theoretical probability distributions. Transformation resulted in improved skewness values and, hence, more normally-distributed variables in three of the four variables. Thus, the log-transformed variables were used in the next steps of data analysis, except for Time spent reading realiable/non-reliable pages.

[see @Salmeron2020, p. 1047]

```{r echo=FALSE, message=FALSE, warning=FALSE}
hist_rq1 = rq1 %>%
    ggplot(aes(EventDuration)) +
    geom_histogram() +
    xlab(str_wrap('Total length of fixations on the web page headers and snippets within the SERP', 
                  width = 32)) +
    ylab('Frequency') +
    annotate('text', 
             x = 120000, 
             y = 8, 
             label = paste0('Skewness: ', 
                            round(
                              skewness(rq1$EventDuration)[1], 2))) +
    annotate('text', 
             x = 120000, 
             y = 7, 
             label = paste0('Kurtosis: ', 
                            round(
                              kurtosis(rq1$EventDuration)[1], 2)))

hist_rq2.1 = rq2_source_features %>%
    ggplot(aes(EventDuration)) +
    geom_histogram() +
    xlab(str_wrap('Total length of fixations on the source features', 
                  width = 32)) +
    ylab('Frequency') +
    annotate('text', 
             x = 80000, 
             y = 6, 
             label = paste0('Skewness: ', 
                            round(
                              skewness(
                                rq2_source_features$EventDuration
                                )[1], 2))) +
    annotate('text', 
             x = 80000, 
             y = 5.5, 
             label = paste0('Kurtosis: ', 
                            round(
                              kurtosis(
                                rq2_source_features$EventDuration
                                )[1], 2)))

hist_rq2.2 = rq2_reliability %>%
    ggplot(aes(EventDuration)) +
    geom_histogram() +
    xlab(str_wrap('Time spent reading realiable/non reliable pages',
                  width = 32)) +
    ylab('Frequency') +
    annotate('text', 
             x = 540000, 
             y = 11, 
             label = paste0('Skewness: ', 
                            round(
                              skewness(
                                rq2_reliability$EventDuration
                                )[1], 2))) +
    annotate('text', 
             x = 540000, 
             y = 10, 
             label = paste0('Kurtosis: ', 
                            round(
                              kurtosis(
                                rq2_reliability$EventDuration
                                )[1], 2)))

hist_rq3 = rq3 %>%
    ggplot(aes(TotalEventDurationOnSERPSum)) +
    geom_histogram() +
    xlab(str_wrap('Total event duration on SERP', 
                  width = 32)) +
    ylab('Frequency') +
    annotate('text', 
             x = 120000, 
             y = 8, 
             label = paste0('Skewness: ', 
                            round(
                              skewness(
                                rq3$TotalEventDurationOnSERPSum
                                )[1], 2))) +
    annotate('text', 
             x = 120000, 
             y = 7, 
             label = paste0('Kurtosis: ', 
                            round(
                              kurtosis(
                                rq3$TotalEventDurationOnSERPSum
                                )[1], 2)))
  

figure1 = arrangeGrob(hist_rq1, 
                      hist_rq2.1, 
                      hist_rq2.2, 
                      hist_rq3, 
                      ncol = 2)

ggsave('figures/Figure1.png', 
       figure1,
       device = 'png', 
       width = 16, 
       height = 16, 
       units = 'cm', 
       dpi = 300)

grid.arrange(figure1)
```

*Figure 1*. Histograms of time variables

```{r echo=FALSE, message=FALSE, warning=FALSE}
rq1 = rq1 %>%
  mutate(log_EventDuration = log(EventDuration))

hist_log_rq1 = rq1 %>%
  ggplot(aes(log_EventDuration)) +
  geom_histogram(aes(y = ..density..)) +
  stat_function(fun = dnorm, 
                args = list(mean = mean(rq1$log_EventDuration), 
                            sd = sd(rq1$log_EventDuration)),
                colour = 'red') +
  xlab(str_wrap('Natural logarithm of total length of fixations on the web page headers and snippets within the SERP',
                width = 32)) +
  ylab('Density') +
  annotate('text', 
           x = 11, 
           y = 1.1, 
           label = paste0('Skewness: ', 
                          round(
                            skewness(
                              rq1$log_EventDuration)[1], 2))) +
  annotate('text', 
           x = 11, 
           y = 1, 
           label = paste0('Kurtosis: ', 
                          round(
                            kurtosis(
                              rq1$log_EventDuration)[1], 2)))

rq2_source_features = rq2_source_features %>%
  mutate(log_EventDuration = log(EventDuration))

hist_log_rq2.1 = rq2_source_features %>%
  ggplot(aes(log_EventDuration)) +
  geom_histogram(aes(y = ..density..)) +
  stat_function(fun = dnorm, 
                args = list(
                  mean = mean(rq2_source_features$log_EventDuration), 
                  sd = sd(rq2_source_features$log_EventDuration)),
                colour = 'red') +
    xlab(str_wrap('Natural logarithm of total length of fixations on the source features', 
                  width = 32)) +
    ylab('Density') +
    annotate('text', 
             x = 11, 
             y = 1.1, 
             label = paste0('Skewness: ', 
                            round(
                              skewness(
                                rq2_source_features$log_EventDuration
                                )[1], 2))) +
    annotate('text', 
             x = 11, 
             y = 1, 
             label = paste0('Kurtosis: ', 
                            round(
                              kurtosis(
                                rq2_source_features$log_EventDuration
                                )[1], 2)))

hist_log_rq2.2 = rq2_reliability %>%
  ggplot(aes(log(EventDuration))) +
  geom_histogram(aes(y = ..density..)) +
  stat_function(fun = dnorm, 
              args = list(
                mean = mean(log(rq2_reliability$EventDuration)), 
                sd = sd(log(rq2_reliability$EventDuration))),
              colour = 'red') +
  xlab(str_wrap('Natural logarithm of time spent reading realiable/non reliable pages',
                width = 32)) +
  ylab('Density') +
  annotate('text', 
           x = 12.7, 
           y = 1.7, 
           label = paste0('Skewness: ', 
                          round(
                            skewness(
                              log(rq2_reliability$EventDuration)
                              )[1], 2))) +
  annotate('text', 
           x = 12.7, 
           y = 1.55, 
           label = paste0('Kurtosis: ', 
                          round(
                            kurtosis(
                              log(rq2_reliability$EventDuration)
                              )[1], 2)))

rq3 = rq3 %>%
  mutate(log_TotalEventDurationOnSERPSum = 
           log(TotalEventDurationOnSERPSum))

hist_log_rq3 = rq3 %>%
  ggplot(aes(log_TotalEventDurationOnSERPSum)) +
  geom_histogram(aes(y = ..density..)) +
  stat_function(fun = dnorm, 
                args = list(
                  mean = mean(rq3$log_TotalEventDurationOnSERPSum,
                              na.rm = T), 
                  sd = sd(rq3$log_TotalEventDurationOnSERPSum,
                          na.rm = T)),
                colour = 'red') +  
  xlab(str_wrap('Total event duration on SERP', 
                width = 32)) +
  ylab('Density') +
  annotate('text', 
           x = 11, 
           y = 1.1, 
           label = paste0('Skewness: ', 
                          round(
                            skewness(
                              rq3$log_TotalEventDurationOnSERPSum
                              )[1], 2))) +
  annotate('text', 
           x = 11, 
           y = 1, 
           label = paste0('Kurtosis: ', 
                          round(
                            kurtosis(
                              rq3$log_TotalEventDurationOnSERPSum
                              )[1], 2)))

figure2 = arrangeGrob(hist_log_rq1, 
                      hist_log_rq2.1, 
                      hist_log_rq2.2, 
                      hist_log_rq3, 
                      ncol = 2)

ggsave('figures/Figure2.png', 
       figure2,
       device = 'png', 
       width = 16, 
       height = 16, 
       units = 'cm', 
       dpi = 300)

grid.arrange(figure2)
```

*Figure 2*. Histograms of transformed time variables with theoretical probability distributions

# Main Analysis

## Research Question 1

To answer the research question "Do EMMEs affect navigation across the results of a search engine research page (SERP) in English as an L2, as measured by the **length of fixations** on the web page headers and snippets within the SERP?", a linear model was fit with the natural logarithm of Total length of fixations as response and Group (two levels: EMME and VIDEO) as predictor.

The model shows a statistically significant effect of Group ($\beta=-0.67, p=.001, 95\% CI=[-1.04, -0.30], R^2=.19, R^2 adjusted=.18$).

```{r include=FALSE}
# Fit model for RQ1
rq1_model = rq1 %>%
  lm(log_EventDuration ~ Group, data = .)
```

**Table 1**

*Total lenght of fixations predicted by Group*

```{r echo=FALSE}
# Print table with statistical results
# tab_model(rq1_model)
```

```{r echo=FALSE}
# Plot model
figure3 = get_model_data(rq1_model, 'eff')$Group %>%
  as_tibble() %>%
  mutate(x = x %>% 
           as_factor() %>%
           recode(`1` = 'EMME', `2` = 'VIDEO')) %>%
  ggplot(aes(x, 
             predicted, 
             ymin = conf.low, 
             ymax = conf.high, 
             label = round(predicted, 2))) +
  geom_errorbar(width = .1) +
  geom_point() +
  geom_text(nudge_x = .15) +
  xlab('Group') + 
  ylab('Event Duration (log(ms))') +
  ylim(c(0, 12))

ggsave('figures/Figure3.png', 
       figure3,
       device = 'png', 
       width = 16, 
       height = 9, 
       units = 'cm', 
       dpi = 300)

figure3
```

*Figure 3*. Log of total lenght of fixations predicted by Group

## Research Question 2

To answer the reserch question "Do EMMEs affect source evaluation of web pages in English as an L2 that either endorse or refute the Learning Styles (LS) misconception, to be analyzed by the **length of fixations** on the source features (banner, author's name and occupation, and references) and on the contrast between **time spent reading reliable/non reliable pages** across groups?" two linear models were fit: the first with the log of total lenght of fixations on the source features as response and Group as predictors; and the second model with total lenght of fixations as response and Group, Realiability and the interaction between the two variables as predictors.

The hypotheses were that "when accessing a web page, participants in the EMME condition will **more likely examine source features** (banner, author's name and occupation, and references) compared to the control group. In addition, **pages considered reliable will be read more carefully, resulting in more fixations, while pages considered less reliable will be only strategically scanned and will thus have fewer fixations**. This difference may not be apparent among participants in the control condition, where participants might skip the source features. The control group may also find it more difficult to distinguish between reliable and non reliable pages, thus reading all texts from beginning to end, resulting in little to no difference in fixation times between reliable and non reliable pages."

The first model shows no statistically significant effects. Thus, there is no evidence supporting a difference between groups in relation to total lenght of fixations in source features. However, as Figure 4 shows, Participants in the VIDEO condition tended to have longer total fixation lenght in comparison with participants in the EMME condition.

The second model shows a statistically significant effect of Group ($\beta=81045.40, p=0.016,95\% CI=[15145.63, 146945.17], R^2=.10, R^2 adjusted=.08$), but no statistically significant effect of Relevance nor Interaction. As Figure 5 shows, participants in the VIDEO condition spent more time reading both reliable/non-reliable pages. Participants in the EMME condition spen more time in Reliable Pages than in Non-Reliable pages, but this difference was not statistically significant condidering the lack of a statistically significant interaction.

```{r include=FALSE}
# Fit model 1 for RQ2
rq2_model1 = rq2_source_features %>%
  lm(log_EventDuration ~ Group, data = .)

# Fit model 2 for RQ2
rq2_model2 = rq2_reliability %>%
  lm(EventDuration ~ Group * AOI, data = .)
```

**Table 2**

*Results of the two models: Total lenght of fixations on the source features predicted by Group and Time spent reading by Group, Relevance and Interaction*

```{r echo=FALSE}
# Print table with statistical results
# tab_model(rq2_model1, rq2_model2)
```

```{r echo=FALSE}
# Plot model
figure4 = get_model_data(rq2_model1, 'eff')$Group %>%
  as_tibble() %>%
  mutate(x = x %>% 
           as_factor() %>%
           recode(`1` = 'EMME', `2` = 'VIDEO')) %>%
  ggplot(aes(x, 
             predicted, 
             ymin = conf.low, 
             ymax = conf.high,
             label = round(predicted, 2))) +
  geom_errorbar(width = .1) +
  geom_point() +
  geom_text(nudge_x = .15) +
  xlab('Group') + 
  ylab('Event Duration (log(ms))') +
  ylim(c(0, 11))

ggsave('figures/Figure4.png', 
       figure4,
       device = 'png', 
       width = 16, 
       height = 9, 
       units = 'cm', 
       dpi = 300)

figure4
```

*Figure 4*. *Total lenght of fixations on the source features predicted by Group*

```{r echo=FALSE}
# Plot model
figure5 = get_model_data(rq2_model2, 'int') %>%
  as_tibble() %>%
  mutate(x = x %>% 
           as_factor() %>%
           recode(`1` = 'EMME', `2` = 'VIDEO')) %>%
  ggplot(aes(x, 
             (predicted/1000), 
             ymin = (conf.low/1000), 
             ymax = (conf.high/1000), 
             color = group_col,
             label = round(predicted/1000, 2))) +
  geom_errorbar(width = .1, position = position_dodge(width = .15)) +
  geom_point(position = position_dodge(width = .15)) +
  geom_text(nudge_x = .2) +
  xlab('Group') + 
  ylab('Event Duration (s)') +
  theme(legend.title = element_blank()) +
  ylim(c(0, 400))

ggsave('figures/Figure5.png', 
       figure5,
       device = 'png', 
       width = 16, 
       height = 9, 
       units = 'cm', 
       dpi = 300)

figure5
```

*Figure 5*. *Total lenght of fixations predicted by Group, Relevance and Interaction*

## Research Question 3

To answer the research question "does self-perceived strategic behavior, as measured by the **Second Language Online Reading Strategy Inventory** (LI, 2020) predict **performance on the navigation task?**" a model was fit with the Sum of the average score on the survey as predictor and the Natural logarithm of total length of fixations on the web page headers and snippets within the SERP as response.

The hyphothesis was that "... the participants who reported a **high frequency of strategy use** in the survey are likely to **benefit more from EMMEs** and **attend more to source features** compared to the participants who reported low frequency of strategy use". As shown in Table 3, no statistically significant effects were observed.

```{r include=FALSE}
# Fit the model RQ3
rq3_model = rq3 %>%
  left_join(rq1 %>%
              select(-EventDuration),
            by = c('Participant' = 'Participant', 
                   'Group' = 'Group')) %>%
  lm(log_EventDuration ~ AverageScoreOnSurveySum, data = .)
```

**Table 3**

*Total length of fixations predicted by the sums of the average scores on the survey*

```{r echo=FALSE}
# Print table with statistical results
# tab_model(rq3_model)
```

## Research Question 4

To answer the research question "do **EMMEs** enhance sensitivity to inaccurate information and updating of misconceptions about Learning Styles, to be analyzed by **the arguments in an essay** and a **multiple-choice pre-test/posttest**?" a mixed-effects model was fit with Mean response as response variable, Group and test (pre and post) and their interactin as predictors, with random intercepts for participants.

The hypothesis were "... a positive effect of EMMEs on the construction of a coherent argumentation in the essays, demonstrating that the participant was able to determine that the Learning styles theory was a misconception and to select arguments to ground her/his opinion based on justification by authority and justification by multiple sources (BRAASCH; BRATEN; BRITT; STEFFENS; STROMSO, 2014)" and "... a greater difference from pre- to posttest regarding misconception update among participants in the EMMEs group compared to the control group."

Table 4 shows a statistically significant effect of Test: participants tended to score higher values in the scale in the posttest in comparison with the pretest $(\beta=1.09, p=.007, CI=[0.30, 1.89], Marginal~R^2=0.07, Conditional~R^2=0.43)$. However, both groups performed similarly, as evidenced by the lack of statistically significant effects of Group and interaction.

```{r include=FALSE}
# Fit model for RQ4
rq4_model = rq4 %>%
  mutate(test = as_factor(test) %>% relevel('pretest')) %>%
  lmer(meanResponse ~ Group * test + (1|Participant), data = .)
```

**Table 4**

*Mean response predicted by Group and Test (pre and post)*

```{r echo=FALSE}
# Print table with statistical results
#tab_model(rq4_model)
```

```{r echo=FALSE}
# Plot model
figure6 = get_model_data(rq4_model, 'int') %>%
  as_tibble() %>%
  mutate(x = x %>% 
           as_factor() %>%
           recode(`1` = 'EMME', `2` = 'VIDEO')) %>%
  ggplot(aes(x, 
             predicted, 
             ymin = conf.low, 
             ymax = conf.high, 
             color = group_col,
             label = round(predicted, 2))) +
  geom_errorbar(width = .1, position = position_dodge(width = .15)) +
  geom_point(position = position_dodge(width = .15)) +
  geom_text(nudge_x = .15) +
  xlab('Group') + 
  ylab('Mean response') +
  theme(legend.title = element_blank())

ggsave('figures/Figure6.png', 
       figure6,
       device = 'png', 
       width = 16, 
       height = 9, 
       units = 'cm', 
       dpi = 300)

figure6
```

*Figure 6*. *Mean response predicted by Group, test and Interaction*

# References
